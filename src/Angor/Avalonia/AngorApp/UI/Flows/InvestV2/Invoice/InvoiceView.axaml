<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:l="clr-namespace:AngorApp.UI.Flows.InvestV2.Invoice"
             xmlns:c="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
             xmlns:conv="clr-namespace:AngorApp.UI.Shared.Controls"
             xmlns:commands="clr-namespace:Zafiro.Avalonia;assembly=Zafiro.Avalonia"
             d:DesignWidth="800"
             mc:Ignorable="d"
             x:Class="AngorApp.UI.Flows.InvestV2.Invoice.InvoiceView" x:DataType="l:IInvoiceViewModel">

    <Design.DataContext>
        <l:InvoiceViewModelSample />
    </Design.DataContext>

    <DockPanel VerticalSpacing="20" Classes="Padded">
        <ListBox SelectedIndex="0" DockPanel.Dock="Top" Background="Transparent" ItemContainerTheme="{StaticResource SmallSelectorListBoxItem}" ItemsSource="{Binding InvoiceTypes}" SelectedItem="{Binding SelectedInvoiceType}"
                 DisplayMemberBinding="{Binding PaymentMethod}">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal" Spacing="10" />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
        </ListBox>
        <Border Classes="Pink Rounded" DockPanel.Dock="Bottom">
            <DockPanel HorizontalSpacing="10" Classes="Padded">
                <Border IsVisible="{Binding !PaymentReceived^}" VerticalAlignment="Center" DockPanel.Dock="Right" Classes="Yellow Rounded SmallPadding">
                    <EdgePanel>
                        <EdgePanel.Content>
                            <TextBlock>Awaiting payment</TextBlock>
                        </EdgePanel.Content>
                        <EdgePanel.StartContent>
                            <c:ProgressRing Height="12" Foreground="#A16207" />
                        </EdgePanel.StartContent>
                    </EdgePanel>
                </Border>
                <Border IsVisible="{Binding PaymentReceived^}" VerticalAlignment="Center" DockPanel.Dock="Right" Classes="ColorPanel Green Rounded SmallPadding">
                    <EdgePanel Content="Payment received" StartContent="{Icon fa-check}" />
                </Border>
                <HeaderedContainer>
                    <HeaderedContainer.Header>
                        <TextBlock Classes="Weight-Light Size-XS" Foreground="#C2410C">Amount Required</TextBlock>
                    </HeaderedContainer.Header>
                    <TextBlock Classes="Weight-Bold Size-L" Foreground="#7C2D12" Text="{Binding Amount.DecimalString}" />
                </HeaderedContainer>
            </DockPanel>
        </Border>
        <HeaderedContainer Classes="LightGray Rounded" DockPanel.Dock="Bottom" Header="{Binding SelectedInvoiceType.Name}">
            <DockPanel>
                <Button DockPanel.Dock="Right" 
                        Command="{Binding Source={x:Static commands:Commands.Instance}, Path=CopyParameter}" 
                        CommandParameter="{Binding SelectedInvoiceType.Address}"
                        Classes="Transparent" ToolTip.Tip="Copy address to clipboard"
                        Padding="4" VerticalAlignment="Center">
                    <ContentControl IconOptions.Size="12" Content="{Icon fa-copy}" />
                </Button>
                <c:ProgressRing IsVisible="{Binding IsLoadingInvoice}" Height="16" Width="16" VerticalAlignment="Center" />
                <TextBlock IsVisible="{Binding !IsLoadingInvoice}" Classes="Weight-Light Size-XS" Text="{Binding SelectedInvoiceType.Address}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis" />
            </DockPanel>
        </HeaderedContainer>
        
        <Panel>
            <c:ProgressRing IsVisible="{Binding IsLoadingInvoice}" Width="100" Height="100" />
            <Image IsVisible="{Binding !IsLoadingInvoice}" Width="300" Height="300"
                   Source="{Binding Path=SelectedInvoiceType.Address, Converter={x:Static conv:AngorConverters.StringToQRCode}}" />
        </Panel>
    </DockPanel>
</UserControl>