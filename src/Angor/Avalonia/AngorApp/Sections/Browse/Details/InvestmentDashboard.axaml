<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:dt="clr-namespace:AngorApp.Sections.Browse.Details"
             xmlns:i="https://github.com/projektanker/icons.avalonia"
             mc:Ignorable="d" d:DesignWidth="1200"
             x:Class="AngorApp.Sections.Browse.Details.InvestmentDashboard"
             x:DataType="dt:IProjectDetailsViewModel">

    <Design.DataContext>
        <dt:ProjectDetailsViewModelDesign IsInsideInvestmentPeriod="False" />
    </Design.DataContext>

    <UserControl.Styles>
        <StyleInclude Source="avares://Zafiro.Avalonia/Styles.axaml" />
    </UserControl.Styles>

    <Card Header="Investment Dashboard" HeaderStartContent="{Icon fa-solid fa-chart-pie}" Theme="{StaticResource WideCard}" Subheader="Manage your investment and track project progress" HeaderAndBodySpacing="30">
        <StackPanel Spacing="25">
            <!-- Investment Opportunity Section -->
            <Panel MaxWidth="600" Margin="20 40">
                <Border Classes="Alert CardAlt" IsVisible="{Binding !IsInsideInvestmentPeriod}" HorizontalAlignment="Center" Padding="20 20 0 20">
                    <EdgePanel StartContentTemplate="{StaticResource BigIcon}" Spacing="20">
                        <EdgePanel.StartContent>
                           <Icon Source="fa-face-frown" />
                        </EdgePanel.StartContent>
                        <TextBlock>
                            <Bold>Sorry, you cannot invest in this project</Bold>
                            <LineBreak />
                            <LineBreak />
                            <Run>The investment period already finished</Run>
                        </TextBlock>
                    </EdgePanel>
                </Border>
                <Border IsVisible="{Binding IsInsideInvestmentPeriod}"
                        Background="{DynamicResource SystemAccentColor}"
                        CornerRadius="15"
                        Opacity="0.8">
                    <Grid RowDefinitions="Auto,*,Auto" Margin="20" RowSpacing="10">
                        <!-- Header -->
                        <StackPanel Grid.Row="0" Spacing="15">
                            <i:Icon FontSize="50" Value="fa-solid fa-star" Foreground="White" />
                            <TextBlock Text="Investment Opportunity"
                                       TextWrapping="Wrap"
                                       HorizontalAlignment="Center"
                                       Classes="SizeBig"
                                       Foreground="White"
                                       FontWeight="Bold" />
                            <TextBlock Text="Join this project and be part of its journey to success"
                                       Foreground="White"
                                       HorizontalAlignment="Center"
                                       TextWrapping="Wrap"
                                       Opacity="0.9" />
                        </StackPanel>

                        <!-- Investment Actions -->
                        <BalancedWrapGrid Grid.Row="2"
                                          MinItemWidth="110"
                                          MaxItemWidth="200"
                                          VerticalSpacing="10"
                                          HorizontalSpacing="10"
                                          HorizontalAlignment="Center">
                            <ReactiveButton Command="{Binding Invest}"
                                            FontSize="{StaticResource FontSizeNormal}"
                                            Classes="Expand"
                                            HorizontalContentAlignment="Center"
                                            FontWeight="Bold">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <i:Icon FontSize="16" Value="fa-solid fa-coins" />
                                    <TextBlock Text="Invest Now" />
                                </StackPanel>
                            </ReactiveButton>

                            <IconButton Icon="{Icon fa-solid fa-info-circle}" Content="Learn more"
                                        FontSize="16"
                                        Classes="Expand"
                                        FontWeight="Bold">
                            </IconButton>
                        </BalancedWrapGrid>
                    </Grid>

                </Border>
            </Panel>

            <!-- Investment Management Section (Hidden by default, shown after investment) -->
            <Card Header="Investment Management"
                  Subheader="Track and manage your investment"
                  IsVisible="False">
                <Card.HeaderStartContent>
                    <i:Icon FontSize="30" Value="fa-solid fa-wallet" />
                </Card.HeaderStartContent>

                <StackPanel Spacing="20">
                    <!-- Investment Stats -->
                    <UniformGrid Columns="3" ColumnSpacing="15">
                        <OverlayBorder Theme="{StaticResource CardOverlayBorder}" Padding="15">
                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                <i:Icon FontSize="20" Value="fa-solid fa-dollar-sign" Foreground="Green" />
                                <TextBlock Text="My Investment" FontSize="12" Opacity="0.7" HorizontalAlignment="Center" />
                                <TextBlock Text="0.5 TBTC" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" />
                            </StackPanel>
                        </OverlayBorder>

                        <OverlayBorder Theme="{StaticResource CardOverlayBorder}" Padding="15">
                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                <i:Icon FontSize="20" Value="fa-solid fa-chart-pie" Foreground="Orange" />
                                <TextBlock Text="My Share" FontSize="12" Opacity="0.7" HorizontalAlignment="Center" />
                                <TextBlock Text="33%" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" />
                            </StackPanel>
                        </OverlayBorder>

                        <OverlayBorder Theme="{StaticResource CardOverlayBorder}" Padding="15">
                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                <i:Icon FontSize="20" Value="fa-solid fa-clock" Foreground="Blue" />
                                <TextBlock Text="Status" FontSize="12" Opacity="0.7" HorizontalAlignment="Center" />
                                <TextBlock Text="Active" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" />
                            </StackPanel>
                        </OverlayBorder>
                    </UniformGrid>

                    <!-- ~1~ Management Actions @1@ -->
                    <!-- <UniformGrid Columns="2" ColumnSpacing="15"> -->
                    <!--     <Button Padding="15,10" CornerRadius="8"> -->
                    <!--         <StackPanel Orientation="Horizontal" Spacing="8"> -->
                    <!--             <i:Icon FontSize="16" Value="fa-solid fa-chart-pie" /> -->
                    <!--             <TextBlock Text="View Performance" /> -->
                    <!--         </StackPanel> -->
                    <!--     </Button> -->
                    <!-- -->
                    <!--     <Button Classes="Expand" Padding="15,10" CornerRadius="8"> -->
                    <!--         <StackPanel Orientation="Horizontal" Spacing="8"> -->
                    <!--             <i:Icon FontSize="16" Value="fa-solid fa-download" /> -->
                    <!--             <TextBlock Text="Download Reports" /> -->
                    <!--         </StackPanel> -->
                    <!--     </Button> -->
                    <!-- </UniformGrid> -->
                </StackPanel>
            </Card>

            <!-- Founder Dashboard Section (Hidden by default, shown for founders) -->
            <Card Header="Founder Dashboard"
                  Subheader="Manage your project and funds"
                  IsVisible="False">
                <Card.HeaderStartContent>
                    <i:Icon FontSize="30" Value="fa-solid fa-user" />
                </Card.HeaderStartContent>

                <StackPanel Spacing="20">
                    <!-- Founder Actions -->
                    <UniformGrid Columns="2" ColumnSpacing="15" RowSpacing="15">
                        <Button Padding="15,12" CornerRadius="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <i:Icon FontSize="16" Value="fa-solid fa-wallet" />
                                <TextBlock Text="Manage Funds" />
                            </StackPanel>
                        </Button>

                        <Button Classes="Secondary" Padding="15,12" CornerRadius="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <i:Icon FontSize="16" Value="fa-solid fa-pen" />
                                <TextBlock Text="Edit Project" />
                            </StackPanel>
                        </Button>

                        <Button Classes="Secondary" Padding="15,12" CornerRadius="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <i:Icon FontSize="16" Value="fa-solid fa-users" />
                                <TextBlock Text="View Investors" />
                            </StackPanel>
                        </Button>

                        <Button Classes="Secondary" Padding="15,12" CornerRadius="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <i:Icon FontSize="16" Value="fa-solid fa-chart-pie" />
                                <TextBlock Text="Analytics" />
                            </StackPanel>
                        </Button>
                    </UniformGrid>
                </StackPanel>
            </Card>
        </StackPanel>
    </Card>
</UserControl>