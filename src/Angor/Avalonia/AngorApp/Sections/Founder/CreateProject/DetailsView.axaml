<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:AngorApp.UI.Controls"
             xmlns:ui="clr-namespace:Zafiro.UI;assembly=Zafiro.UI"
             xmlns:createProject="clr-namespace:AngorApp.Sections.Founder.CreateProject"
             mc:Ignorable="d" d:DesignWidth="800"
             x:Class="AngorApp.Sections.Founder.CreateProject.DetailsView"
             x:DataType="createProject:ICreateProjectViewModel">

    <Design.DataContext>
        <createProject:CreateProjectViewModelDesign StartDate="1/2/2026" ExpiryDate="12/12/2025" EndDate="12/12/2025">
            <createProject:CreateProjectViewModelDesign.Stages>
                <createProject:CreateProjectStageDesign Percent="10" StartDate="10/5/2025" />
                <createProject:CreateProjectStageDesign Percent="30" StartDate="10/9/2025" />
                <createProject:CreateProjectStageDesign Percent="70" StartDate="12/12/2025" />
            </createProject:CreateProjectViewModelDesign.Stages>
        </createProject:CreateProjectViewModelDesign>
    </Design.DataContext>

    <UserControl.Styles>
        <Style Selector="Card Card">
            <Setter Property="Theme" Value="{StaticResource TransparentCard}" />
            <Setter Property="HeaderStartContentTemplate" Value="{StaticResource SmallIcon}" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="HeaderPadding" Value="8" />
        </Style>
    </UserControl.Styles>

    <ScrollViewer>
        <StackPanel>
            <Card Header="Target Fundraising Goal" Subheader="Set up your investment campaign parameters">
                <Card.HeaderStartContent>
                    <ui:Icon Source="mdi-target" />
                </Card.HeaderStartContent>
                <Card Header="Target Amount" Subheader="Minimum BTC this project is trying to raise">
                    <controls:AmountControl />
                </Card>
            </Card>
            <Card Header="Fund Raising Window">
                <Card.HeaderStartContent>
                    <ui:Icon Source="fa-regular fa-calendar" />
                </Card.HeaderStartContent>
                <StackPanel>
                    <Card Header="Start Date" Subheader="This is when the investment period begins (automatically set today).">
                        <Card.HeaderStartContent>
                            <ui:Icon Source="fa-regular fa-calendar-days" />
                        </Card.HeaderStartContent>
                        <TextBox IsReadOnly="True" Text="{Binding StartDate, StringFormat='d'}" />
                    </Card>
                    <Card Header="End Date" Subheader="This is when the investment period ends (must be before first stage date).">
                        <Card.HeaderStartContent>
                            <ui:Icon Source="fa-regular fa-calendar-days" />
                        </Card.HeaderStartContent>
                        <CalendarDatePicker SelectedDate="{Binding EndDate}" />
                    </Card>
                </StackPanel>
            </Card>
            <Card Header="Advanced Parameters">
                <Card.HeaderStartContent>
                    <ui:Icon Source="mdi-dots-horizontal-circle-outline" />
                </Card.HeaderStartContent>
                <StackPanel>
                    <Card Header="Penalty Days" Subheader="Number of days to lock funds for departing investors who wish to withdraw early.">
                        <Card.HeaderStartContent>
                            <ui:Icon Source="mdi-lock-open" />
                        </Card.HeaderStartContent>
                        <TextBox Watermark="Enter the penalty days" Text="{Binding PenaltyDays}" />
                    </Card>
                    <Card Header="Expiry Date" Subheader="Emergency date when all remaining funds can be released in case of project abandonment. Automatically set to 60 days after the last stage.">
                        <Card.HeaderStartContent>
                            <ui:Icon Source="fa-regular fa-calendar-days" />
                        </Card.HeaderStartContent>
                        <CalendarDatePicker SelectedDate="{Binding ExpiryDate}" />
                    </Card>
                </StackPanel>
            </Card>
            <Card Header="Stages">
                <DockPanel>
                    <IconButton Command="{Binding AddStage}" Margin="0 10 0 0" DockPanel.Dock="Bottom" Content="Add Stage">
                        <IconButton.Icon>
                            <ui:Icon Source="fa-plus" />
                        </IconButton.Icon>
                    </IconButton>
                    <ItemsControl ItemsSource="{Binding Stages}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="createProject:ICreateProjectStage">
                                <Grid ColumnDefinitions="Auto 100* Auto" Margin="0 5" ColumnSpacing="20">
                                    <HeaderedContainer Theme="{StaticResource InlineHeaderedContainer}">
                                        <TextBox TextAlignment="Center" Text="{Binding Percent}">
                                            <TextBox.InnerRightContent>
                                                <TextBlock VerticalAlignment="Center" Margin="0 0 10 0">%</TextBlock>
                                            </TextBox.InnerRightContent>
                                        </TextBox>
                                    </HeaderedContainer>
                                    <HeaderedContainer Grid.Column="1" HorizontalAlignment="Center" Header="Date" Theme="{StaticResource InlineHeaderedContainer}">
                                        <DatePicker HorizontalAlignment="Left" SelectedDate="{Binding StartDate}" />
                                    </HeaderedContainer>
                                    <Button Command="{Binding Remove}" Grid.Column="2">
                                        <ui:Icon Source="fa-trash" />
                                    </Button>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </DockPanel>
            </Card>
        </StackPanel>
    </ScrollViewer>

</UserControl>